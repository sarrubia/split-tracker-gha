"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.submitterManagerFactory = void 0;
var syncTaskComposite_1 = require("../syncTaskComposite");
var eventsSyncTask_1 = require("./eventsSyncTask");
var impressionsSyncTask_1 = require("./impressionsSyncTask");
var impressionCountsSyncTask_1 = require("./impressionCountsSyncTask");
function submitterManagerFactory(params) {
    var settings = params.settings, storage = params.storage, splitApi = params.splitApi;
    var log = settings.log;
    var submitters = [
        (0, impressionsSyncTask_1.impressionsSyncTaskFactory)(log, splitApi.postTestImpressionsBulk, storage.impressions, settings.scheduler.impressionsRefreshRate, settings.core.labelsEnabled),
        (0, eventsSyncTask_1.eventsSyncTaskFactory)(log, splitApi.postEventsBulk, storage.events, settings.scheduler.eventsPushRate, settings.startup.eventsFirstPushWindow)
        // @TODO add telemetry submitter
    ];
    if (storage.impressionCounts)
        submitters.push((0, impressionCountsSyncTask_1.impressionCountsSyncTaskFactory)(log, splitApi.postTestImpressionsCount, storage.impressionCounts));
    return (0, syncTaskComposite_1.syncTaskComposite)(submitters);
}
exports.submitterManagerFactory = submitterManagerFactory;
