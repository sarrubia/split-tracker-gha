import { IIntegrationManager, IIntegrationFactoryParams } from '../integrations/types';
import { ISignalListener } from '../listeners/types';
import { ILogger } from '../logger/types';
import { ISdkReadinessManager } from '../readiness/types';
import { IFetch, ISplitApi, IEventSourceConstructor } from '../services/types';
import { IStorageAsync, IStorageSync, ISplitsCacheSync, ISplitsCacheAsync, IStorageFactoryParams } from '../storages/types';
import { ISyncManager, ISyncManagerFactoryParams } from '../sync/types';
import { IImpressionObserver } from '../trackers/impressionObserver/types';
import { IImpressionsTracker, IEventTracker } from '../trackers/types';
import { SplitIO, ISettings, IEventEmitter } from '../types';
export interface ISdkFactoryContext {
    storage: IStorageSync | IStorageAsync;
    sdkReadinessManager: ISdkReadinessManager;
    settings: ISettings;
    impressionsTracker: IImpressionsTracker;
    eventTracker: IEventTracker;
    signalListener?: ISignalListener;
    syncManager?: ISyncManager;
}
/**
 * Environment related dependencies.
 * These getters are called a fixed number of times per factory instantiation.
 */
export interface IPlatform {
    getOptions?: () => object;
    getFetch?: () => (IFetch | undefined);
    getEventSource?: () => (IEventSourceConstructor | undefined);
    EventEmitter: new () => IEventEmitter;
}
/**
 * Object parameter with the modules required to create an SDK factory instance
 */
export interface ISdkFactoryParams {
    settings: ISettings;
    platform: IPlatform;
    storageFactory: (params: IStorageFactoryParams) => IStorageSync | IStorageAsync;
    splitApiFactory?: (settings: ISettings, platform: IPlatform) => ISplitApi;
    syncManagerFactory?: (params: ISyncManagerFactoryParams) => ISyncManager;
    sdkManagerFactory: (log: ILogger, splits: ISplitsCacheSync | ISplitsCacheAsync, sdkReadinessManager: ISdkReadinessManager) => SplitIO.IManager | SplitIO.IAsyncManager;
    sdkClientMethodFactory: (params: ISdkFactoryContext) => ({
        (): SplitIO.ICsClient;
        (key: SplitIO.SplitKey, trafficType?: string | undefined): SplitIO.ICsClient;
    } | (() => SplitIO.IClient) | (() => SplitIO.IAsyncClient));
    SignalListener?: new (syncManager: ISyncManager | undefined, // Used by NodeSignalListener to flush data, and by BrowserSignalListener to close streaming connection.
    settings: ISettings, // Used by BrowserSignalListener
    storage: IStorageSync | IStorageAsync, // Used by BrowserSignalListener
    serviceApi: ISplitApi | undefined) => ISignalListener;
    integrationsManagerFactory?: (params: IIntegrationFactoryParams) => IIntegrationManager | undefined;
    impressionsObserverFactory?: () => IImpressionObserver;
    extraProps?: (params: ISdkFactoryContext) => object;
}
